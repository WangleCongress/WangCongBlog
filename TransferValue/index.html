<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>TransferValue | 聪哥的技术笔记</title><link rel="stylesheet" type="text/css" href="/WangCongBlog/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/WangCongBlog/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/WangCongBlog/favicon.ico"><link rel="apple-touch-icon" href="/WangCongBlog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/WangCongBlog/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">TransferValue</h1><a id="logo" href="/WangCongBlog/.">聪哥的技术笔记</a><p class="description">科技是一种生活。——比特网</p></div><div id="nav-menu"><a class="current" href="/WangCongBlog/."><i class="fa fa-home"> Start</i></a><a href="/WangCongBlog/archives/"><i class="fa fa-archive"> Archiv</i></a><a href="/WangCongBlog/about/"><i class="fa fa-user"> Über</i></a><a href="/WangCongBlog/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">TransferValue</h1><div class="post-meta">Mar 19, 2019</div><div class="post-content"><p>ASP.NET页面之间传递值的几种方式（转载）<br>　页面传值是学习asp.net初期都会面临的一个问题，总的来说有页面传值、存储对象传值、ajax、类、model、表单等。但是一般来说，常用的较简单有QueryString，Session，Cookies，Application，Server.Transfer。</p>
<p>　　一、QueryString</p>
<p>　　QueryString是一种非常简单的传值方式，他可以将传送的值显示在浏览器的地址栏中。如果是传递一个或多个安全性要求不高或是结构简单的数值时，可以使用这个方法。但是对于传递数组或对象的话，就不能用这个方法了。</p>
<p>　　这种方法的优点：1.使用简单，对于安全性要求不高时传递数字或是文本值非常有效。<br>　　这种方法的缺点：1.缺乏安全性，由于它的值暴露在浏览器的URL地址中的。<br>　　　　　　　　　　2.不能传递对象。</p>
<p>　　使用方法：1.在源页面的代码中用需要传递的名称和值构造URL地址。<br>　　　　　　　2.在源页面的代码用Response.Redirect(URL);重定向到上面的URL地址中。<br>　　　　　　　3.在目的页面的代码使用Request.QueryString[“name”];取出URL地址中传递的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">private void Button1_Click(object sender, System.EventArgs e) </span><br><span class="line">&#123; </span><br><span class="line">　　string s_url; </span><br><span class="line">　　s_url = &quot;b.aspx?name=&quot; + Label1.Text; </span><br><span class="line">　　Response.Redirect(s_url); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void Page_Load(object sender, EventArgs e) </span><br><span class="line">&#123; </span><br><span class="line">　　Label2.Text = Request.QueryString[&quot;name&quot;]; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>　　二、Session</p>
<p>　　想必这个肯定是大家使用中最常见的用法了，其操作与Application类似，作用于用户个人，所以，过量的存储会导致服务器内存资源的耗尽。</p>
<p>　　优点：1.使用简单，不仅能传递简单数据类型，还能传递对象。<br>　　　　　2.数据量大小是不限制的。</p>
<p>　　缺点：1.在Session变量存储大量的数据会消耗较多的服务器资源。</p>
<p>　　　　　2.容易丢失。</p>
<p>　　使用方法：1.在源页面的代码中创建你需要传递的名称和值构造Session变量:Session[“Name”]=”Value(Or Object)”;</p>
<p>　　　　　　　2.在目的页面的代码使用Session变量取出传递的值。Result = Session[“Nmae”]</p>
<p>　　注意：session不用时可以销毁它，销毁的方法是：清除一个：Session.Remove(“session名”);</p>
<p>　　　　　　　　　　　　　　　　　　　　　　　　　清除所有：Session.Clear();</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">private void Button1_Click(object sender, System.EventArgs e) </span><br><span class="line">&#123; </span><br><span class="line">　　Session[&quot;name&quot;] = Label.Text; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void Page_Load(object sender, EventArgs e) </span><br><span class="line">&#123; </span><br><span class="line">　　string name; </span><br><span class="line">　　name = Session[&quot;name&quot;].ToString(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>　　三、Cookie</p>
<p>　　这个也是大家常使用的方法，Cookie用于在用户浏览器上存储小块的信息，保存用户的相关信息，比如用户访问某网站时用户的ID，用户的偏好等，用户下次访问就可以通过检索获得以前的信息。所以Cookie也可以在页面间传递值。Cookie通过HTTP头在浏览器和服务器之间来回传递的。Cookie只能包含字符串的值，如果想在Cookie存储整数值，那么需要先转换为字符串的形式。</p>
<p>　　与Session一样，其是什对每一个用户而言的，但是有个本质的区别，即Cookie是存放在客户端的，而session是存放在服务器端的。而且Cookie的使用要配合ASP.NET内置对象Request来使用。</p>
<p>　　优点：1.使用简单，是保持用户状态的一种非常常用的方法。比如在购物网站中用户跨多个页面表单时可以用它来保持用户状态。</p>
<p>　　缺点：1.常常被人认为用来收集用户隐私而遭到批评。</p>
<p>　　　　　2.安全性不高，容易伪造。</p>
<p>　　<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">　　使用方法：1.在源页面的代码中创建你需要传递的名称和值构造Cookie对象:</span><br><span class="line"></span><br><span class="line">HttpCookie objCookie = new HttpCookie(&quot;myCookie&quot;,&quot;Hello,Cookie!&quot;);</span><br><span class="line">Response.Cookies.Add(cookie); </span><br><span class="line">　　　　　　2.在目的页面的代码使用Cookie对象取出传递的值：Result = Request.Cookies[ &quot;myCookie&quot; ].Value;</span><br><span class="line"></span><br><span class="line">private void Button1_Click(object sender, System.EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">　　HttpCookie objCookie = new HttpCookie(&quot;myCookie&quot;,&quot;Hello,Cookie!&quot;);</span><br><span class="line">　　Response.Cookies.Add(objCookie); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">string myName1Value;</span><br><span class="line">myName1Value = Request.Cookies[ &quot;myCookie&quot; ].Value;</span><br></pre></td></tr></table></figure></p>
<p>　　四、Application</p>
<p>　　Application对象的作用范围是整个全局，也就是说对所有用户都有效。它在整个应用程序生命周期中都是有效的，类似于使用全局变量一样，所以可以在不同页面中对它进行存取。它和Session变量的区别在于，前者是所有的用户共用的全局变量，后者是各个用户独有的全局变量。</p>
<p>　　可能有人会问，既然所有用户都可以使用application变量，那他可以用在什么场合呢？这里举个例子：网站访问数。多个请求访问时都可以对它进行操作。</p>
<p>　　优点：1.使用简单，消耗较少的服务器资源。</p>
<p>　　　　　2.不仅能传递简单数据，还能传递对象。</p>
<p>　　　　　3.数据量大小是不限制的。</p>
<p>　　缺点：1.作为全局变量容易被误操作。所以单个用户使用的变量一般不能用application。</p>
<p>　　使用方法：1.在源页面的代码中创建你需要传递的名称和值构造Application变量:Application[“Nmae”]=”Value(Or Object)”;</p>
<p>　　　　　　　2.在目的页面的代码使用Application变量取出传递的值。Result = Application[“Nmae”]</p>
<p>　　注意：常用lock和unlock方法用来锁定和解锁，为了防止并发修改。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">private void Button1_Click(object sender, System.EventArgs e) </span><br><span class="line">&#123; </span><br><span class="line">　　Application[&quot;name&quot;] = Label1.Text; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void Page_Load(object sender, EventArgs e) </span><br><span class="line">&#123; </span><br><span class="line">　　string name; </span><br><span class="line">　　Application.Lock(); </span><br><span class="line">　　name = Application[&quot;name&quot;].ToString(); </span><br><span class="line">　　Application.UnLock(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>　　五、Server.Transfer</p>
<p>　　这个才可以说是面象对象开发所使用的方法，其使用Server.Transfer方法把流程从当前页面引导到另一个页面中，新的页面使用前一个页面的应答流，所以这个方法是完全面象对象的，简洁有效。</p>
<p>　　Server.Transfer是从当前的ASPX页面转到新的ASPX页面，服务器端执行新页并输出,在新页面中通过Context.Handler来获得前一个页面传递的各种数据类型的值、表单数据、QueryString.由于重定向完全在服务器端完成，所以客户端浏览器中的URL地址是不会改变的。调用Server.Transfer时，当前的ASPX页面终止执行，执行流程转入另一个ASPX页面，但新的ASPX页面仍使用前一ASPX页面创建的应答流。</p>
<p>　　ps：比较Server.Transfer和Response.Redirect的区别。<br>　　　　(1)Server.Transfer在服务器端完成，所以客户端浏览器中的URL地址是不会改变的；Response.Redirect是客户端完成，向服务器端提出新的页面处理请求，所以客户端浏览器中的URL地址是会改变的。<br>　　　　(2)Server.Transfer在服务器端完成,不需要客户端提出请求，减少了客户端对服务器端提出请求。[2]<br>　　　　(3)Server.Transfer只能够转跳到本地虚拟目录指定的页面,也就是工程项目中的页面，而Response.Redirect则十分灵活,可以跳转到任何URL地址。<br>　　　　(4)Server.Transfer可以将前一个页面的各种类型的值传到新的页面；Response.Redirect则只能借助URL中带参数或是结合上面四种办法把各种类型的值传到新的页面。</p>
<p>　　优点：1.直接在服务器端重定向，使用简单方便，减少了客户端对服务器端提出请求。</p>
<p>　　　　　2.可以传递各种数据类型的值和控件的值。</p>
<p>　　缺点：1.客户端浏览器中的URL地址是不改变，会导致在新的页面可能出现一些意想不到的问题。比如如果源页面和目的页面不在同一个虚拟目录或其子目录下，那么使用相对路径的图片、超链接都会导致错误的指向。</p>
<p>　　使用方法：1.在源页面的代码中，使用Page类的Server.Transfer跳到另一个页面传递页面数据：Server.Transfer(“b.aspx”,”false”)。</p>
<p>　　　　　　　2.在目的页面中，使用Context.Handler来接收数据：FormerPage formerPage = (FormerPage)Context.Handler; 然后用formerPage的属性和方法来获取前一个页面的值，或者直接用Context.Items[“myParameter “]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public string Name </span><br><span class="line">&#123; </span><br><span class="line">　　get&#123; return Label1.Text;&#125; </span><br><span class="line">&#125; </span><br><span class="line">private void Button1_Click(object sender, System.EventArgs e) </span><br><span class="line">&#123; </span><br><span class="line">　　Server.Transfer(&quot;b.aspx&quot;); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void Page_Load(object sender, EventArgs e) </span><br><span class="line">&#123; </span><br><span class="line">　　a newWeb; //实例a窗体 </span><br><span class="line">　　newWeb = (source)Context.Handler; </span><br><span class="line">　　string name; </span><br><span class="line">　　name = newWeb.Name; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>　　以上就是常用的几种页面间传值的方法，我一般使用session和querystring来传值，少数情况会使用到cookie。本篇文章仅仅是介绍这几种方法的使用方法，内部原理没有过多的解释，关于session的存储方式请参见：session的存储方式和配置</p>
<p>　　</p>
<p>　　参考文章：1、ASP.NET页面之间传递值的几种方式</p>
<p>　　　　　　　2、ASP.NET页面之间传递值的几种方法</p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/WangCongBlog/Cache/">asp.net缓存(转载）</a><a class="next" href="/WangCongBlog/SearchDemo/">SearchDemo</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://wanglecongress.github.io/WangCongBlog"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Kategorien</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/WangCongBlog/tags/git/" style="font-size: 15px;">git</a> <a href="/WangCongBlog/tags/项目管理/" style="font-size: 15px;">项目管理</a> <a href="/WangCongBlog/tags/微信/" style="font-size: 15px;">微信</a> <a href="/WangCongBlog/tags/Web编程/" style="font-size: 15px;">Web编程</a> <a href="/WangCongBlog/tags/数据库/" style="font-size: 15px;">数据库</a> <a href="/WangCongBlog/tags/服务器/" style="font-size: 15px;">服务器</a> <a href="/WangCongBlog/tags/云计算/" style="font-size: 15px;">云计算</a> <a href="/WangCongBlog/tags/ASP-NET/" style="font-size: 15px;">ASP.NET</a> <a href="/WangCongBlog/tags/搜索技术/" style="font-size: 15px;">搜索技术</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Letzte</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/Elasticsearch/">Elasticsearch</a></li><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/Cache/">asp.net缓存(转载）</a></li><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/TransferValue/">TransferValue</a></li><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/SearchDemo/">SearchDemo</a></li><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/DotNET-IO/">DotNET_IO</a></li><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/005_WeiFuWu/">什么是微服务？</a></li><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/004_MSSQL/">MSSQL</a></li><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/003_ASPDotNET/">ASP.NET</a></li><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/001_Github/">玩转Github之论Git与Github的正确打开方式</a></li><li class="post-list-item"><a class="post-list-link" href="/WangCongBlog/002_WeChat/">微信的公众号和小程序怎么来的，了解一下？</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/WangCongBlog/." rel="nofollow">聪哥的技术笔记.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/WangCongBlog/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/WangCongBlog/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/WangCongBlog/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/WangCongBlog/js/smartresize.js?v=0.0.0"></script></div></body></html>